<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900">
  <defs>
    <style>
      .table-box { stroke: #333; stroke-width: 2; fill: #f5f5f5; }
      .table-title { font-weight: bold; font-size: 14px; fill: #fff; }
      .table-title-bg { fill: #4a90e2; }
      .table-field { font-size: 12px; fill: #333; }
      .pk { font-weight: bold; color: #e74c3c; }
      .fk { color: #3498db; }
      .relationship-line { stroke: #7f8c8d; stroke-width: 2; fill: none; }
      .relationship-label { font-size: 11px; fill: #555; font-weight: bold; }
    </style>
  </defs>

  <!-- Title -->
  <text x="700" y="30" style="font-size: 24px; font-weight: bold; text-anchor: middle;">
    Secure Blue Voting System - Entity Relationship Diagram (ERD)
  </text>

  <!-- USERS TABLE -->
  <rect x="50" y="100" width="220" height="280" class="table-box"/>
  <rect x="50" y="100" width="220" height="30" class="table-title-bg"/>
  <text x="160" y="120" class="table-title" text-anchor="middle">USERS</text>
  
  <text x="65" y="145" class="table-field"><tspan class="pk">ğŸ”‘ id</tspan> (UUID, PK)</text>
  <text x="65" y="165" class="table-field"><tspan class="pk">ğŸ“§ email</tspan> (UNIQUE)</text>
  <text x="65" y="185" class="table-field">password (VARCHAR)</text>
  <text x="65" y="205" class="table-field">full_name (VARCHAR)</text>
  <text x="65" y="225" class="table-field">national_id (VARCHAR)</text>
  <text x="65" y="245" class="table-field">role (ENUM: user|admin)</text>
  <text x="65" y="265" class="table-field">created_at (TIMESTAMP)</text>
  <text x="65" y="285" class="table-field">updated_at (TIMESTAMP)</text>

  <!-- ELECTIONS TABLE -->
  <rect x="400" y="100" width="250" height="310" class="table-box"/>
  <rect x="400" y="100" width="250" height="30" class="table-title-bg"/>
  <text x="525" y="120" class="table-title" text-anchor="middle">ELECTIONS</text>
  
  <text x="415" y="145" class="table-field"><tspan class="pk">ğŸ”‘ id</tspan> (UUID, PK)</text>
  <text x="415" y="165" class="table-field"><tspan class="fk">ğŸ”— created_by</tspan> (FKâ†’Users)</text>
  <text x="415" y="185" class="table-field">title (VARCHAR)</text>
  <text x="415" y="205" class="table-field">description (TEXT)</text>
  <text x="415" y="225" class="table-field">start_date (DATE)</text>
  <text x="415" y="245" class="table-field">end_date (DATE)</text>
  <text x="415" y="265" class="table-field">status (ENUM: pending|active|closed)</text>
  <text x="415" y="285" class="table-field">created_at (TIMESTAMP)</text>
  <text x="415" y="305" class="table-field">updated_at (TIMESTAMP)</text>

  <!-- CANDIDATES TABLE -->
  <rect x="250" y="500" width="250" height="280" class="table-box"/>
  <rect x="250" y="500" width="250" height="30" class="table-title-bg"/>
  <text x="375" y="520" class="table-title" text-anchor="middle">CANDIDATES</text>
  
  <text x="265" y="545" class="table-field"><tspan class="pk">ğŸ”‘ id</tspan> (UUID, PK)</text>
  <text x="265" y="565" class="table-field"><tspan class="fk">ğŸ”— election_id</tspan> (FKâ†’Elections)</text>
  <text x="265" y="585" class="table-field">name (VARCHAR)</text>
  <text x="265" y="605" class="table-field">party (VARCHAR)</text>
  <text x="265" y="625" class="table-field">bio (TEXT)</text>
  <text x="265" y="645" class="table-field">votes (INT, default 0)</text>
  <text x="265" y="665" class="table-field">created_at (TIMESTAMP)</text>
  <text x="265" y="685" class="table-field">updated_at (TIMESTAMP)</text>

  <!-- VOTES TABLE -->
  <rect x="600" y="500" width="240" height="280" class="table-box"/>
  <rect x="600" y="500" width="240" height="30" class="table-title-bg"/>
  <text x="720" y="520" class="table-title" text-anchor="middle">VOTES</text>
  
  <text x="615" y="545" class="table-field"><tspan class="pk">ğŸ”‘ id</tspan> (UUID, PK)</text>
  <text x="615" y="565" class="table-field"><tspan class="fk">ğŸ”— user_id</tspan> (FKâ†’Users)</text>
  <text x="615" y="585" class="table-field"><tspan class="fk">ğŸ”— election_id</tspan> (FKâ†’Elections)</text>
  <text x="615" y="605" class="table-field"><tspan class="fk">ğŸ”— candidate_id</tspan> (FKâ†’Candidates)</text>
  <text x="615" y="625" class="table-field">created_at (TIMESTAMP)</text>
  <text x="615" y="650" style="font-size: 11px; fill: #e74c3c; font-weight: bold;">
    â­ UNIQUE: (user_id, election_id)
  </text>
  <text x="615" y="670" style="font-size: 11px; fill: #555;">
    Prevents duplicate votes
  </text>

  <!-- AUDIT_LOGS TABLE -->
  <rect x="950" y="500" width="300" height="280" class="table-box"/>
  <rect x="950" y="500" width="300" height="30" class="table-title-bg"/>
  <text x="1100" y="520" class="table-title" text-anchor="middle">AUDIT_LOGS</text>
  
  <text x="965" y="545" class="table-field"><tspan class="pk">ğŸ”‘ id</tspan> (UUID, PK)</text>
  <text x="965" y="565" class="table-field"><tspan class="fk">ğŸ”— user_id</tspan> (FKâ†’Users, nullable)</text>
  <text x="965" y="585" class="table-field">action (VARCHAR)</text>
  <text x="965" y="605" class="table-field">entity_type (VARCHAR)</text>
  <text x="965" y="625" class="table-field">entity_id (VARCHAR)</text>
  <text x="965" y="645" class="table-field">old_value (JSON)</text>
  <text x="965" y="665" class="table-field">new_value (JSON)</text>
  <text x="965" y="685" class="table-field">created_at (TIMESTAMP)</text>

  <!-- RELATIONSHIPS -->
  
  <!-- Users to Elections (1:M) -->
  <line x1="160" y1="380" x2="450" y2="410" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="280" y="390" class="relationship-label">1:M (created_by)</text>

  <!-- Elections to Candidates (1:M) -->
  <line x1="450" y1="410" x2="375" y2="500" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="380" y="450" class="relationship-label">1:M</text>

  <!-- Elections to Votes (1:M) -->
  <line x1="525" y1="410" x2="680" y2="500" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="570" y="450" class="relationship-label">1:M</text>

  <!-- Users to Votes (1:M) -->
  <line x1="270" y1="380" x2="670" y2="500" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="450" y="430" class="relationship-label">1:M (user votes)</text>

  <!-- Candidates to Votes (1:M) -->
  <line x1="375" y1="500" x2="650" y2="500" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="500" y="495" class="relationship-label">1:M</text>

  <!-- Users to Audit Logs (1:M) -->
  <line x1="270" y1="380" x2="1050" y2="500" class="relationship-line" marker-end="url(#arrowhead)"/>
  <text x="620" y="430" class="relationship-label">1:M (audit)</text>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#7f8c8d"/>
    </marker>
  </defs>

  <!-- Legend -->
  <rect x="50" y="820" width="1300" height="60" style="stroke: #ccc; stroke-width: 1; fill: #f9f9f9;"/>
  <text x="70" y="845" style="font-weight: bold; font-size: 12px;">Legend:</text>
  <text x="180" y="845" style="font-size: 11px;">ğŸ”‘ PK = Primary Key | </text>
  <text x="350" y="845" style="font-size: 11px;">ğŸ”— FK = Foreign Key | </text>
  <text x="520" y="845" style="font-size: 11px;">1:M = One-to-Many Relationship | </text>
  <text x="780" y="845" style="font-size: 11px;">â­ Unique Constraint = Prevents Duplicates</text>
  <text x="70" y="865" style="font-size: 10px; fill: #666;">Key Features: UUID Primary Keys | Cascading Delete on Foreign Keys | Timestamps on All Tables</text>
</svg>
